enum SubscriptionType {
  month
  year
  per_case
  per_hour
  per_session
}

enum Status {
  draft
  pending
  published
  rejected
  approved
  inactive
}

model Service {
  id                    Int     @id @default(autoincrement())
  pid                   String
  slug                  String? @unique
  title                 String
  description           String
  titleNormalized       String? // Normalized title for accent-insensitive search
  descriptionNormalized String? // Normalized description for accent-insensitive search

  // Taxonomies
  category    String
  subcategory String
  subdivision String
  tags        String[]

  // Pricing
  fixed            Boolean
  price            Int?              @default(0)
  /// [ServiceType]
  type             Json // Boolean fields: online, presence, oneoff, onbase, subscription, onsite
  subscriptionType SubscriptionType?
  duration         Int?              @default(0) // days for duration

  // Features
  /// [ServiceAddon]
  addons Json[] // title, description, price
  /// [ServiceFAQ]
  faq    Json[] // question, answer

  // Media
  /// [Media]
  media Json? // service media/images

  // Misc
  featured Boolean @default(false)

  // Reviews and Rating
  rating      Float @default(0)
  reviewCount Int   @default(0)

  status    Status   @default(draft)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  reviews   Review[]
  profile   Profile  @relation(fields: [pid], references: [id], onDelete: Cascade)
  savedBy   SavedService[]

  @@index([pid])
  @@index([status, featured])
  @@index([category])
  @@index([subcategory, subdivision])
  @@index([price, fixed])
  @@index([titleNormalized])
  @@map("services")
}
